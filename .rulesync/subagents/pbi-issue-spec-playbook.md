---
name: pbi-issue-spec-playbook
targets: ["*"]
description: "指定PBIのIssue（PBI本文 + BE/FEサブIssue）を、最新要件に基づく『仕様書として機能するMarkdown』へ更新するための手順書。"
---

## 目的
指定されたPBI（`GitHub/issues/...` 配下のMarkdown）を、**要件定義が進んだ前提**で「仕様書として読める」状態に更新する。

- PBI本文: **ビジネス寄り**（ユーザーが何をできるか / 受入条件 / 参照 / UI）
- サブIssue（BE/FE）: **実装寄り**（API/DynamoDB/画面仕様/状態遷移/テストケース）

## 対象ファイルの想定
- PBI本文: `GitHub/issues/[PBI] */<issue番号> - [PBI] *.md`
- サブIssue: `GitHub/issues/[PBI] */sub-issues/*.md`

## 成果物の定義（Definition of Done）
### PBI本文（ビジネス寄り仕様）
- 画面の「ユーザー行動」が分かる（表示・検索・遷移・並び順など）
- **受入条件**がテスト可能な粒度で列挙されている
- **UIセクション**にFigmaリンク（node-id付き）とスクリーンショットがある
- **参照（根拠）**に、関連ドキュメントへのリンク（少数でOK）がある

### BEサブIssue（実装寄り仕様）
- APIの責務が明確（例: 「全件取得のみ」など）
- DynamoDBのテーブル設計が **Markdown表**で記載されている（PK/SK含む）
- 主要なテストケース（正常/異常）が書かれている

### FEサブIssue（実装寄り仕様）
- Figmaと一致する表示（カード項目、件数表示、入力、遷移）が明確
- ローディング/空状態/エラー/リトライの状態が明確
- テストケース（表示/検索/遷移/状態）が書かれている

## 手順（このリポジトリ内の情報を探索して更新する）
### 1) 対象PBIの現状を把握
- 対象PBI本文（Markdown）を全文読む
- 配下のサブIssue（BE/FE）を全文読む

### 2) 関連ドキュメントを探索して「根拠」を揃える
以下を優先的に探す（あれば参照へ追加する）。
- `Backlog/issues/` の該当テーマの詳細協議
- `Backlog/documents/` の項目定義（マスタ項目、連携仕様など）
- `MTG/` の議事録（意思決定の根拠になっている箇所）
- `共有資料/` の要件整理（機能要件など）
- `GitHub/issues/` の関連PBI（依存・前提になる意思決定）

### 3) PBI本文を「ビジネス寄り仕様」に書き換える
推奨テンプレ:
- 概要（仕様サマリー）
- 背景 / 目的
- 対象画面
- 仕様
- UI（Figma）
- タスク（Sub-issues）
- 受入条件（Acceptance Criteria）
- 参照（根拠/関連ドキュメント）

### 4) BEサブIssueを「実装仕様 + テスト」へ更新
最低限含める:
- 目的（このAPIが満たすこと）
- エンドポイント
- リクエスト/レスポンス
- DynamoDB設計（テーブル設計をMarkdown表）
- テストケース（正常/異常）

### 5) FEサブIssueを「画面仕様 + テスト」へ更新
最低限含める:
- 目的
- UI（Figma）
- 画面仕様（表示項目、入力、遷移、状態）
- API連携
- テストケース

### 6) フィードバック反映（反復）
ユーザーからのフィードバックは即反映する。
