# 店舗マスター項目定義

## 概要

FM様から提供される店舗マスタCSVファイルの項目定義を記載します。

## CSVフォーマット

- 文字コード: UTF-8（BOM付き）
- 区切り文字: カンマ（,）
- 囲み文字: ダブルクォーテーション（"）
- 改行コード: CRLF
- ヘッダー行: あり

## 項目定義

| No | 項目名（物理） | 項目名（論理） | 型 | 必須 | 最大長 | 説明 | 例 |
|----|---------------|---------------|-----|------|--------|------|-----|
| 1 | shop_code | 店舗コード | String | ○ | 10 | 店舗を一意に識別するコード | SHP001 |
| 2 | shop_name | 店舗名 | String | ○ | 100 | 店舗の正式名称 | ファッションモール渋谷店 |
| 3 | shop_name_kana | 店舗名（カナ） | String | ○ | 200 | 店舗名のフリガナ | ファッションモールシブヤテン |
| 4 | postal_code | 郵便番号 | String | ○ | 7 | ハイフンなし7桁 | 1500001 |
| 5 | prefecture | 都道府県 | String | ○ | 10 | 都道府県名 | 東京都 |
| 6 | city | 市区町村 | String | ○ | 50 | 市区町村名 | 渋谷区 |
| 7 | address | 住所 | String | ○ | 100 | 市区町村以降の住所 | 神宮前1-2-3 |
| 8 | building | 建物名 | String | - | 100 | 建物名・階数など | ○○ビル 3F |
| 9 | phone_number | 電話番号 | String | ○ | 15 | 店舗の電話番号 | 03-1234-5678 |
| 10 | business_hours | 営業時間 | String | ○ | 100 | 営業時間の説明 | 10:00〜21:00 |
| 11 | regular_holiday | 定休日 | String | - | 100 | 定休日の説明 | 年中無休 |
| 12 | website_url | WebサイトURL | String | - | 500 | 店舗のWebサイトURL | https://example.com/shop/shibuya |
| 13 | line_account_url | LINE公式アカウントURL | String | - | 500 | LINE公式アカウントへのリンク | https://lin.ee/xxxxx |
| 14 | terms_url | 個別利用規約URL | String | - | 500 | 店舗固有の利用規約URL | https://example.com/terms/shibuya |
| 15 | is_active | 有効フラグ | Boolean | ○ | - | true: 有効、false: 無効 | true |
| 16 | area_name | エリア名 | String | ○ | 50 | 表示用のエリア名 | 渋谷エリア |
| 17 | sort_order | 表示順 | Number | ○ | - | 一覧表示時のソート順 | 1 |
| 18 | note | 備考 | String | - | 500 | 管理用の備考欄 | 2025年12月オープン |

## CSVサンプル

```csv
"shop_code","shop_name","shop_name_kana","postal_code","prefecture","city","address","building","phone_number","business_hours","regular_holiday","website_url","line_account_url","terms_url","is_active","area_name","sort_order","note"
"SHP001","ファッションモール渋谷店","ファッションモールシブヤテン","1500001","東京都","渋谷区","神宮前1-2-3","○○ビル 3F","03-1234-5678","10:00〜21:00","年中無休","https://example.com/shop/shibuya","https://lin.ee/shibuya","https://example.com/terms/shibuya","true","渋谷エリア","1",""
"SHP002","ファッションモール新宿店","ファッションモールシンジュクテン","1600022","東京都","新宿区","新宿3-4-5","△△タワー 5F","03-2345-6789","10:00〜22:00","年中無休","https://example.com/shop/shinjuku","https://lin.ee/shinjuku","https://example.com/terms/shinjuku","true","新宿エリア","2",""
"SHP003","ファッションモール池袋店","ファッションモールイケブクロテン","1710022","東京都","豊島区","南池袋2-3-4","□□プラザ 2F","03-3456-7890","10:00〜21:00","年中無休","https://example.com/shop/ikebukuro","https://lin.ee/ikebukuro","https://example.com/terms/ikebukuro","true","池袋エリア","3",""
```

## 取り込み仕様

### 取り込みタイミング
- 日次バッチ（毎日 AM 3:00）
- S3へのファイルアップロードをトリガーとした即時取り込み

### 取り込み処理
1. S3にCSVファイルがアップロードされる
2. S3イベントでLambda関数が起動
3. CSVをパースし、バリデーション実行
4. DynamoDBのShopsテーブルに upsert
5. 処理結果をCloudWatch Logsに出力

### エラーハンドリング
- バリデーションエラー: 該当行をスキップし、エラーログを出力
- 致命的エラー: 処理を中断し、アラート通知

## 変更履歴

| 日付 | バージョン | 変更内容 | 担当者 |
|------|-----------|----------|--------|
| 2025/11/19 | 1.0 | 初版作成 | FM様・田中 |
| 2025/11/26 | 1.1 | area_name、sort_order追加 | FM様・田中 |
